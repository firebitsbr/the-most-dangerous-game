<!DOCTYPE html>
<html>
  <head>
    <title>The Most Dangerous Game</title>
    <meta charset="utf-8">

    <link rel="icon" type="image/x-icon" href="img/favicon.ico">

    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/octicons.css">

    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Yanone Kaffeesatz'; }
      h1, h2 {
        font-weight: 400;
        margin-bottom: 0;
      }
      h4{
        font-family: 'Yanone Kaffeesatz';
        font-weight: light;
      }
      img { border-radius: 20px; }
      ul {
        list-style-type: circle;
        font-size: 1.75em;
      }
      i {
        color: #E0051C;
      }
      strong {
        font-weight: bolder;
      }
      a {
        color: #E0051C;
      }
      .img-alt { border-radius: 0px; }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
      /* Reverse slide layout */
      .inverse {
        background: #272822;
        color: #777872;
        text-shadow: 0 0 20px #333;
      }
      .black {
        background: #000;
      }
      .inverse h1, .inverse h2, .inverse h3 {
        color: #f3f3f3;
        line-height: 0.8em;
      }
      /* Two-column layout */
      .left-column {
        color: #777;
        width: 20%;
        height: 92%;
        float: left;
      }
      .left-column h2:last-of-type, .left-column h3:last-child {
        color: #000;
      }
      .right-column {
        width: 75%;
        float: right;
        padding-top: 1em;
      }
    </style>
  </head>
  <body>
    <textarea id="source">

class: class: middle, center, black
![](img/dangerous_game.png)

???

Give a brief introduction.

---

class: center, middle
layout: true

---

# @sroberts
# ![](img/sroberts.jpg)
# DFIR Engineer __@__ GitHub

---

![](img/me-at-psu.jpg)

## 2005

---

class: center, middle
# Class of _2016_

???

- Technically my second senior year.

---

![](img/ohio.gif)

---

# Originally Written & Presented with __@__[kylemaxwell](https://twitter.com/kylemaxwell) At [SANS CTI Summit](https://www.sans.org/event/cyber-threat-intelligence-summit-2015)

---

class: center, middle
# Cyber Threat Intelligence
## ?? DEFINITION STILL NEEDED ??

---
background-image: url(img/hunting.jpg)

class: center, middle, inverse
# Hunting __(IR)__ vs Hunting __(TI)__

???

- IR: Proactively looking for adversaries in an environment
- TI: Gathering information about adversaries

---

# What is "The Most Dangerous Game"??

---

![](img/novel.jpg)

???

- A novel by Richard Connell
- Also called the Hounds of Zaroff
- Released in 1924

---

class: middle, right, inverse

# Intelligence Concepts
## _That Everyone Knows And Already Agrees on Right...?_

---

class: middle
layout: false

# Data vs Intelligence
- __Data__ is a raw piece of information without context
- __Intelligence__ has gone through the Intelligence Cycle

---

class: middle
# [The Intelligence Cycle](http://sroberts.github.io/2015/02/16/cycles-intelligence/)
- Requirements
- Collection
- Processing
- Analysis
- Dissemination
- Feedback

---

class: middle
# [F3EAD](http://sroberts.github.io/2015/03/24/f3ead/)
- Find
- Fix
- Finish
- Exploit
- Analyze
- Disseminate

---

class: middle, right, inverse
# The Target

---

class: middle, center
# What is Targeting?
## _Making a plan for focusing threat research & investigation_

---

class: middle
# Targeting Methodologies
- Actor Centric
- Target Centric
- Technology Centric

???
Technology Centric: Rare, unless you're defending something really unique like ICS.

---

class: middle, center
# Feeds
## Needles in Haystacks

???

- What business typically thinks of when they think of Threat Intelligence

---

class: middle
## <i class="fa fa-quote-left"></i> My 5.4 gazillion indicators can beat up your threat indicators. Garbage in garbage out #ThreatIntel

### ~ @[rickhholland](https://twitter.com/rickhholland)

---

class: center, middle

# Honeypots
## Bringing the Bad Guys to You

---

class: center, middle
# Old School: [Honeynet Project](https://www.honeynet.org/)

# New Hotness: [Modern Honey Network](https://threatstream.github.io/mhn/)

???

- Modern Honeynet was created by ThreatStream

---

class: center, middle
# Vuln Info
## Taking Care of your own Toys

---

class: middle
## <i class="fa fa-quote-left"></i> Structured vulnerability analysis is not threat intelligence it is requirements gathering for threat intelligence.

### ~ @[selil](https://twitter.com/selil)

---

class: center, middle
# Vendor Info
## Services & APIs

---

class: center, middle
# Review Your Own Incidents
## Mine that fancy incident management system...

---

class: center, middle
# Review Your Others Incidents
## By Sharing or News Mining

---

class: middle, right, inverse
layout: false

# The Hunt

---

class: middle
layout: true

---

class: center

# What to Analyze: _Actors_

---

class: middle
# What to Analyze: Actors | Criminal
- Primary Weapon: Google
- Social Networks (Twitter, Facebook)
- Underground Forums
- Demands & Correspondence

???

- Remember country specific social networks.

---

class: middle
# What to Analyze: Actors | Espionage
- Malware & System Artifacts
- Whois/Registrar Data
- Tactics, Techniques, & Proceedures
- Actions Over Target

???

This is hard

---

class: center

# What to Analyze: _Technical Sources_

---

# Technical Sources

.left-column[
### Malware
]
.right-column[
### Malware Sources
- VXShare
- VirusTotal
- Malwr.com

### Reversing Goals
- C2 Info
- Destinctive Strings
- Developer Artifacts
- Capabilities
]

---

# Technical Sources

.left-column[
### Malware
### Passive DNS
]
.right-column[
### What it is?
- Continously identifies DNS record changes
- What resolved to what, and when?

### Providers
- DNSDB (Farsight)
- PassiveTotal
- VirusTotal
]

---

# Technical Sources

.left-column[
### Malware
### Passive DNS
### Whois
]
.right-column[
### What it is?
- The registrar information for DNS names & IPAddresses

### Sources
- DomainTools ($$$)
- WhoDat for Ongoing Tracking
]

---

# Technical Sources

.left-column[
### Malware
### Passive DNS
### Whois
### Certificates
]
.right-column[
![](img/ssl.png)
]

???

- Certificates are hard to change.

---

class: middle
# How to Keep Tracking

---

class: middle
# Threat Library
- [CRITs](https://crits.github.io/) is popular, [MISP](http://www.misp-project.org/) also
- Lighter solutions (like wikis) often work
- Market hasn't fully addressed this

---

# Web Monitoring Systems
- [Netflix Scumblr](https://github.com/Netflix/Scumblr) Meta Search (Works alongside Sketchy)
- [Recorded Future](https://www.recordedfuture.com/)
- Lots of custom development

---

# Malware Monitoring
- [VirusTotal](https://www.virustotal.com/) is King
- Malware feeds with lots of custom internal solutions
- [Maltrieve](https://github.com/krmaxwell/maltrieve), [Viper](https://github.com/viper-framework/viper), & [Cuckoo](http://www.cuckoosandbox.org/)
- [Yara](https://plusvic.github.io/yara/) (We'll get to that...)

---

# Internal Logging
- Firewall, IDS, & Proxy
- Web, mail, & DNS
- Authentication & Audit

---

class: middle, right, inverse
layout: false
# The "Kill"

???

- Actually executing against the adversary

---

class: middle, center
layout: true

---

# Incident Response
## The Entire Goal... Right?

???
- Mitigation
- Remediation
- Recovery

---

![](http://www.moretricks.com/wp-content/uploads/2012/04/Spying-on-Someones-Mobile-Phone-Without-Physical-Access.png)
# "KICK ‘EM OUT NOW!" or "Wait and see..."

???
Enigma Example

---

# The Imitation Game
![](img/imitation.jpg)
## Don’t let them know that you know that they know…

???

---

# Attribution
![](img/cruise.jpg)
## Doesn’t matter unless you have cruise missiles... <br> _Or handcuffs..._

---

layout: false
class: middle

# Intel Driven Responses
- Deny
- Decieve
- Degrade
- Disrupt
- Destroy

---

class: middle, right, inverse
# The Hunting Stories

---

class: middle, center
# <i class="fa fa-envelope"></i> Communication
## _Who can make use of this information?_
## _Who might be able to provide additional intel?_

???

Has to be done carefully.

---

class: center, middle

# Intelligence Products
# IOCs <i class="fa fa-arrow-right"></i> RFIs <i class="fa fa-arrow-right"></i> Short Form <i class="fa fa-arrow-right"></i> Long Form

---

# Indicators of Compromise
.left-column[
## STIX
]
.right-column[
### STIX is a language [...] for the specification, capture, characterization and communication of standardized cyber threat information.
```xml
<stix:Indicators>
        <stix:Indicator xsi:type="indicator:IndicatorType" id="example:Indicator-33fe3b22-0201-47cf-85d0-97c02164528d" timestamp="2014-05-08T09:00:00.000000Z">
            <indicator:Title>IP Address for known C2 channel</indicator:Title>
            <indicator:Type xsi:type="stixVocabs:IndicatorTypeVocab-1.1">IP Watchlist</indicator:Type>
            <indicator:Observable  id="example:Observable-1c798262-a4cd-434d-a958-884d6980c459">
                <cybox:Object id="example:Object-1980ce43-8e03-490b-863a-ea404d12242e">
                    <cybox:Properties xsi:type="AddressObject:AddressObjectType" category="ipv4-addr">
                        <AddressObject:Address_Value condition="Equals">10.0.0.0</AddressObject:Address_Value>
                    </cybox:Properties>
                </cybox:Object>
            </indicator:Observable>
            <indicator:Indicated_TTP>
                <stixCommon:TTP idref="example:TTP-bc66360d-a7d1-4d8c-ad1a-ea3a13d62da9" />
            </indicator:Indicated_TTP>
        </stix:Indicator>
...
```
]

---

# Indicators of Compromise
.left-column[
## STIX
## OpenIOC
]
.right-column[
### "OpenIOC was originally designed to enable MANDIANT’s products to codify intelligence in order to rapidly search for potential security breaches."
```xml
<short_description>DUQU (METHODOLOGY)</short_description>
<description>
Indicator for the duqu trojan. The initial duqu driver will decode and inject a dll (marked as .pnf) into a system process (usually services.exe). The injected dll contains another dll encoded within it's resource section which it will inject into other processes as identified within its encoded configuruation file (another .pnf file). This second injected dll is responsible for all backdoor/C2 communication.
</description>
<authored_by>MANDIANT</authored_by>
<authored_date>2011-10-21T16:13:31</authored_date>
<links>
  <link rel="caveat">Methodology</link>
</links>
<definition>
  <Indicator operator="OR" id="9fd46693-ee1c-4d31-b732-35bf952651e3">
  <Indicator operator="AND" id="e4deb0af-7558-498e-b953-6e70ec694767">
  <IndicatorItem id="d5b29cfe-8599-498a-b805-326273fe10c5" condition="contains">
    <Context document="FileItem" search="FileItem/PEInfo/DigitalSignature/CertificateSubject" type="mir"/>
    <Content type="string">C-Media Electronics Incorporation</Content>
...
```
]

---

# Indicators of Compromise
.left-column[
## STIX
## OpenIOC
## Snort
]
.right-column[
### Snort's signatures are the most common network activity representation
```xml
alert tcp $EXTERNAL_NET any -> $HOME_NET any
(
  msg:"SCAN XMAS";
  flow:stateless;
  flags:SRAFPU,12;
  reference:arachnids,144;
  classtype:attempted-recon;
  sid:625;
  rev:7;
)
```
### Useful with other tools than just Snort
]

???

- Snort sigs are also usable by many tools

---

# Indicators of Compromise
.left-column[
## STIX
## OpenIOC
## Snort
## Yara
]
.right-column[
### Malware centric AntiVirus signature style IOCs

```json
rule silent_banker : banker
{
    meta:
        description = "This is just an example"
        thread_level = 3
        in_the_wild = true

    strings:
        $a = {6A 40 68 00 30 00 00 6A 14 8D 91}
        $b = {8D 4D B0 2B C1 83 C0 27 99 6A 4E 59 F7 F9}
        $c = "UVODFRYSIHLNWPEJXQZAKCBGMT"

    condition:
        $a or $b or $c
}
```
### Useful locally, in various tools, even on VirusTotal
]

---

# Intelligence Products

.left-column[
## RFIs
]
.right-column[
## Purpose:
- Short document answering one question
- Fast response focused on IOCs

## Audience:
- CSuite <i class="fa fa-angle-double-right"></i> TI Team
- TI Team <i class="fa fa-angle-double-right"></i> 3rd Party Intel Vendor
- TI Team <i class="fa fa-angle-double-right"></i> Peer Intel Group
]

???
- Shortest form possible with fastest turn around
- Fast response

---

# Intelligence Products

.left-column[
## RFIs
## Short Form
]
.right-column[
## Purpose:
- Intermediate support for incident response
- Quick summary major aspects of attack & actors

## Audience:
- Incident Response Team
- Internal Technical Teams
]

???

- Short Forms: Indicator heavy

---

# Intelligence Products

.left-column[
## RFIs
## Short Form
## Long Form
]
.right-column[
## Purpose:
- “All Source” Intelligence Products
- Detailing full actor lifecycles

## Audience:
- Executive Team
- Public Relase (for PR)
]

???

- Long Forms: Require a mature team

---

class: center, middle

# Audience
## Internal: Team & Organization
## External: Peers & Wide

---

class: middle, right, inverse
# The Use Case: Going Postal

---

class: center, middle
![](img/postal_report.png)

---

# Step 1: Search for "My Targets"
--

## Found Nothing

???

- By this i mean look for GitHub or GitHub Related things

---

# Step 2: Extract IOCs

--

![](img/jager.png)

---

class: middle
## 24 IPv4 addresses detected
## 11 URLs detected
## 1 email addresses detected
## 6 Web files detected
## 16 SHA256s detected

???

- The 11 URLs were mostly false positives

---

# Step 3: Secondary Sources
- Google to the rescue!
- Other vendor information (The "Me Too"s)
- Threat APIs
- Mailing lists
- Discuss with friends & colleagues

---

# Step 3: Enrich IOCs

--
- Use PassiveTotal passive DNS to get more IPs & URLs
- Gather current and historic whois data
- Use VirusTotal to find malware or related malware

???

- Fuzzy hashes are your friend

---

# Step 4: Build & Deploy Detection

--
- Snort signatures for network activity
- Yara rules for malware
- Basic blacklists
- Correlation rules & alerts

---

# Step 5: Read the Report

--

## _If we find something_

---

class: middle, right, inverse
# The Joke

???

Tell the Story of YoloThre.at

---

class: center
# [YoloThre.at](http://yolothre.at/)
## Open source docker containers for Threat Intel
![](img/yolothreat.png)


---

class: middle, right, inverse
# Review

---

layout: false
class: left, middle
# Review
- The Target
- The Hunt
- The “Kill”
- The Hunting Stories
- The Case Study

---

# If You Want to get into Threat Hunting
- Learn the players (Vendors & Attackers)
- Learn ~~basic~~ advanced development
- Language skills are really valuable
- Get a secondary skill
- Read everthing on security, intel, international relations...

???
- Front End: HTML/CSS/Javascript
- Scripting/Middleware: Python or Ruby
- Backend: Go, Java, or CSS

---

class: middle, center, inverse
# ![](img/hail-octdra.png)
# GitHub Security is Growing...

???

We just started our internship program, look for us in 2016

---

class: middle, right, inverse
# Questions??

---

background-image: url(img/shai.gif)
class: bottom, center
# Thanks!!!


    </textarea>
    <!-- <script src="https://gnab.github.io/remark/downloads/remark-latest.min.js"> -->
    <script src="js/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create();
    </script>
  </body>
</html>
